const VulnerabilityPageBoundary = require('./../logic/boundaries/vulnerabilityPageBoundary');

let assert = require('assert');
let jsonScanConfig = '{"url": "http://google.com","pageHash": 311321,"type": "Cookie","value": "SESSIONID=123"}';
let type = "Cookie";
let sessionValue = "SESSIONID=123";
let pageHash = 311321;
let url = "http://google.com";
let boundary = new VulnerabilityPageBoundary(url, pageHash, type, sessionValue);

describe('Test deserialize', function () {
    it('Should create VulnerabilityPageBoundary with correct parameters', function () {
        let vulnPageBoundary = VulnerabilityPageBoundary.deserialize(jsonScanConfig);
        assert.equal(vulnPageBoundary.url, url);
        assert.equal(vulnPageBoundary.pageHash, pageHash);
        assert.equal(vulnPageBoundary.type, type);
        assert.equal(vulnPageBoundary.value, sessionValue);
    });
});

describe('Test serialize', function () {
    it('Should serialzie to {"url": "http://google.com","pageHash": 311321,"type": "Cookie","value": "SESSIONID=123"}', function () {
        let serialize = boundary.serialize();
        assert.equal(boundary.url, JSON.parse(serialize).url);
        assert.equal(boundary.pageHash, JSON.parse(serialize).pageHash);
        assert.equal(boundary.type, JSON.parse(serialize).type);
        assert.equal(boundary.value, JSON.parse(serialize).value);
    });
});