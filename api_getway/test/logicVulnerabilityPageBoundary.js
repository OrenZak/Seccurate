const VulnerabilityPageBoundary = require('../logic/boundaries/vulnerabilityPageBoundary');

var assert = require('assert');
var jsonScanConfig = '{"url": "http://google.com","pageHash": 311321,"type": "Cookie","value": "SESSIONID=123","algoType":"ALL","tableName":"Name"}';
var type = "Cookie";
var sessionValue = "SESSIONID=123";
var pageHash = 311321;
var url = "http://google.com";
var algoType = "ALL";
var tableName = "Name";
var boundary = new VulnerabilityPageBoundary(url, pageHash, type, sessionValue, algoType, tableName);

describe('Test deserialize', function () {
    it('Should create VulnerabilityPageBoundary with correct parameters', function () {
        var vulnPageBoundary = VulnerabilityPageBoundary.deserialize(jsonScanConfig);
        assert.equal(vulnPageBoundary.url, url);
        assert.equal(vulnPageBoundary.pageHash, pageHash);
        assert.equal(vulnPageBoundary.type, type);
        assert.equal(vulnPageBoundary.value, sessionValue);
        assert.equal(vulnPageBoundary.algoType, algoType);
        assert.equal(vulnPageBoundary.tableName, tableName);
    });
});

describe('Test serialize', function () {
    it('Should serialzie to {"url": "http://google.com","pageHash": 311321,"type": "Cookie","value": "SESSIONID=123","algoType":"ALL","tableName":"Name"}', function () {
        var serialize = boundary.serialize();
        assert.equal(boundary.url, JSON.parse(serialize).url);
        assert.equal(boundary.pageHash, JSON.parse(serialize).pageHash);
        assert.equal(boundary.type, JSON.parse(serialize).type);
        assert.equal(boundary.value, JSON.parse(serialize).value);
        assert.equal(boundary.tableName, JSON.parse(serialize).tableName);
        assert.equal(boundary.algoType, JSON.parse(serialize).algoType);
    });
});