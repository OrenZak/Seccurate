from VulnerabilitiesObjects import SimpleVulnerabilityEntity
from VulnerabilityDescriptionCRUD import VulnerabilityDescriptionCRUD
from VulnerabilityDescriptionObject import VulnerabilityDescriptionObject

class VulnerabilityBoundary:

    def __init__(self,vulnEntity):
        self.__payload = vulnEntity.getPayload()
        self.__url = vulnEntity.getURL()
        self.__requestB64 = vulnEntity.getRequestB64()
        self.__vulnID = vulnEntity.getVulnDescriptor()
        self.__name, self.__severity, self.__description, self.__recommendations = self.getDescriptorAttributes(self.__vulnID)

    def getPayload(self):
        return self.__payload

    def setPayload(self, payload):
        self.__payload = payload

    def getURL(self):
        return self.__url

    def setURL(self, url):
        self.__url = url

    def getRequestB64(self):
        return self.__requestB64

    def setRequestB64(self, requestB64):
        self.__requestB64 = requestB64

    def getName(self):
        return self.__name

    def setName(self, name):
        self.__name = name

    def getSeverity(self):
        return self.__severity

    def setSeverity(self, severity):
        self.__severity = severity

    def getDescription(self):
        return self.__description

    def setDescription(self, description):
        self.__description = description

    def getRecommendations(self):
        return self.__recommendations

    def setRecommendations(self, recommendations):
        self.__recommendations = recommendations

    def convertToSimpleVulnerabilityEntity(self):
        return SimpleVulnerabilityEntity(vuln_descriptor=self.__vulnID, url=self.__url, payload=self.__payload, requestB64=self.__requestB64)

    def getDescriptorAttributes(self, vulnDescriptor):
        conn = VulnerabilityDescriptionCRUD.getInstance('C:\DB\VulnsDescription.db') #will later on get from configuration file
        vuln = conn.getVulnByID(vulnDescriptor)
        return (vuln.getName(), vuln.getSeverity(), vuln.getDescription(), vuln.getRecommendations())

    def serialize(self):
        pass

    def deserialize(self):
        pass