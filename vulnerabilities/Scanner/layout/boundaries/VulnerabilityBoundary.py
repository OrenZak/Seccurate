from VulnerabilitiesObjects import SimpleVulnerabilityEntity
from VulnerabilityDescriptionObject import VulnerabilityDescriptionEntity
import json

class VulnerabilityBoundary:
    def __init__(self, vulnEntity, vulnDescriptionEntity):
        self.__payload = vulnEntity.getPayload()
        self.__url = vulnEntity.getURL()
        self.__affected_urls = vulnEntity.getAffectedURLs()
        self.__requestB64 = vulnEntity.getRequestB64()
        self.__vulnID = vulnEntity.getID()
        self.__name = vulnDescriptionEntity.getName()
        self.__severity = vulnDescriptionEntity.getSeverity()
        self.__description = vulnDescriptionEntity.getDescription()
        self.__recommendations = vulnDescriptionEntity.getRecommendations()

    def getPayload(self):
        return self.__payload

    def setPayload(self, payload):
        self.__payload = payload

    def getURL(self):
        return self.__url

    def setURL(self, url):
        self.__url = url

    def getRequestB64(self):
        return self.__requestB64

    def setRequestB64(self, requestB64):
        self.__requestB64 = requestB64

    def getName(self):
        return self.__name

    def setName(self, name):
        self.__name = name

    def getSeverity(self):
        return self.__severity

    def setSeverity(self, severity):
        self.__severity = severity

    def getDescription(self):
        return self.__description

    def setDescription(self, description):
        self.__description = description

    def getRecommendations(self):
        return self.__recommendations

    def setRecommendations(self, recommendations):
        self.__recommendations = recommendations

    def getAffectedURLs(self):
        return self.__affected_urls

    def setAffectedURLs(self, affected_urls):
        self.__affected_urls = affected_urls

    def convertToSimpleVulnerabilityEntity(self):
        vulnEntity = SimpleVulnerabilityEntity(id=self.__vulnID,
                                               name=self.__name,
                                               url=self.__url,
                                               affected_urls=self.__affected_urls,
                                               payload=self.__payload,
                                               requestB64=self.__requestB64)

        return vulnEntity

    def convertToVulnerabilityDescriptionEntity(self):
        vulnDescriptorEntity = VulnerabilityDescriptionEntity(
            name=self.__name,
            severity=self.__severity,
            description=self.__description,
            recommendations=self.__recommendations)
        return vulnDescriptorEntity

    def serialize(self):
        return json.dumps(self, default=lambda o: o.__dict__, sort_keys=True)

    @staticmethod
    def deserialize(serializedObject):
        None
